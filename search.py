import requests
import base64


def do_search():
    headers = {"User-Agent": "Mozilla/5.0(WindowsNT10.0;Win64;x64;rv:81.0)Gecko/20100101Firefox/81.0"}

    strquery = '(banner="MinIO" || header="MinIO" || title="MinIO Browser") && country="CN"'.encode()
    bquery = base64.b64encode(strquery)
    fquery = str(bquery, "utf-8")
    url = "https://fofa.info/api/v1/search/all?email=邮箱&key=APIkey" + "&qbase64=" + fquery + "&page=1&size=10000&results={ip}"
    # print(url)
    html = requests.get(url=url, headers=headers).json()
    # print(html)

    with open("./urls.txt", 'w') as f:
        results = html["results"]
        for ll in results:
            # print(ll[0])
            f.write(ll[0] + '\n')


if __name__ == '__main__':
    do_search()

